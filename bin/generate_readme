#! /usr/bin/env ruby

require 'erb'
require 'fileutils'
require 'pathname'
require 'logger'

logger = Logger.new(STDOUT)

root_dir = Pathname.new(__dir__).join('..')
images_dir = root_dir.join('images')

images = images_dir.glob('*/*/Dockerfile').map {|f| "#{f.parent.parent.basename}:#{f.parent.basename}" }
images += images_dir.glob('*/Dockerfile').map {|f| f.parent.basename.to_s }

erb = ERB.new(DATA.read, trim_mode: '-')

root_dir.join('README.md').write(erb.result(binding))

__END__
# Devfiles

A collection of Devfiles and docker images for eclipse che.

## Images

<%- images.each do |img| -%>
- ghcr.io/mtsmfm/devfiles/<%= img %>
<%- end -%>

You can find all images on GitHub packages page:

https://github.com/mtsmfm/devfiles/pkgs/container/devfiles
