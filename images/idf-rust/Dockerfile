# DO NOT EDIT
# Generated by bin/generate_files
FROM espressif/idf-rust@sha256:ca532aee361cd07e38df831fbee5e81a72eb071253be0fd0a2ac6420c5e4b290

RUN apt-get update && apt-get install -y sudo less wget curl git

ENV KUBECTL_VERSION v1.22.1
RUN wget https://dl.k8s.io/release/$KUBECTL_VERSION/bin/linux/amd64/kubectl -O /usr/bin/kubectl && chmod +x /usr/bin/kubectl

RUN wget -O- https://github.com/mtsmfm/che-cli/releases/download/0.2.0/che-cli-0.2.0-linux-amd64.tar.gz | tar -xzv -C /usr/bin && mv /usr/bin/che-cli /usr/bin/che

RUN echo "ALL ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

COPY --chown=0:0 entrypoint.sh /
RUN mkdir -p /home/user && \
  chgrp -R 0 /home /etc/passwd /etc/group /etc/shadow && \
  chmod -R g=u /home /etc/passwd /etc/group /etc/shadow && \
  chmod +x /entrypoint.sh

RUN apt-get update && apt-get install -y linux-tools-5.4.0-77-generic hwdata
RUN update-alternatives --install /usr/local/bin/usbip usbip /usr/lib/linux-tools/5.4.0-77-generic/usbip 20
RUN chmod -R ugo+rw /opt

ENV HOME /home/user
ENV LANG C.UTF-8
WORKDIR /projects

ENTRYPOINT ["/entrypoint.sh"]
CMD ["bash", "-c", "trap : TERM INT; sleep infinity & wait"]
