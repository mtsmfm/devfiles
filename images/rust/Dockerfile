# DO NOT EDIT
# Generated by bin/generate_dockerfiles
FROM rust:1.54.0-buster

RUN apt-get update && apt-get install -y sudo less wget curl make gettext autoconf

ENV GIT_VERSION 2.26.0
RUN mkdir /git \
  && wget -O - https://github.com/git/git/archive/refs/tags/v${GIT_VERSION}.tar.gz | tar -xzv -C /git/ \
  && cd /git/git-${GIT_VERSION} \
  && make configure \
  && ./configure --prefix=/usr \
  && make \
  && make install \
  && rm -rf /git

ENV KUBECTL_VERSION v1.22.1
RUN wget https://dl.k8s.io/release/$KUBECTL_VERSION/bin/linux/amd64/kubectl -O /usr/bin/kubectl && chmod +x /usr/bin/kubectl

RUN echo "ALL ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

COPY --chown=0:0 entrypoint.sh /
RUN mkdir -p /home/user && \
  chgrp -R 0 /home /etc/passwd /etc/group /etc/shadow && \
  chmod -R g=u /home /etc/passwd /etc/group /etc/shadow && \
  chmod +x /entrypoint.sh

ENV HOME /home/user
ENV LANG C.UTF-8
WORKDIR /projects

ENTRYPOINT ["/entrypoint.sh"]
CMD ["tail", "-f", "/dev/null"]
